{% extends 'base.html' %}
{% load static %}
{% load socialaccount %}

{% block content %}
    {% if user.is_authenticated %}
        <div class="sidebar sidebar-left">
            {% if user.is_authenticated %}
            <div class = "choose-style-text">ImageStyle</div>
            <div class = "choose-style-base">
                <div class="dropdown">
            <button class="choose-style-button" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            choose style　　　　　　　　　　　　　＞</button>
          <ul class="dropdown-menu" style="color: black;" >
            <li><a class="dropdown-item" href="#">Action</a></li>
            <li><a class="dropdown-item" href="#">Another action</a></li>
            <li><a class="dropdown-item" href="#">Something else here</a></li>
          </ul>
        </div>
            </div>

                <form action="{% url 'index' %}" method="post">
                    {% csrf_token %}

                    {% if image %}
                        <div class="prompt">Prompt</div>
                        <textarea class="sidebar-textarea" name="prompt" id="prompt" rows="5" cols="30"
                                  placeholder="テキストを入力してください">{{ image.prompt }}</textarea>
                        <div class="prompt">Negative_Prompt</div>
                        <textarea class="sidebar-textarea" name="negative_prompt" id="negative_prompt" rows="5"
                                  cols="30"
                                  placeholder="テキストを入力してください">{{ image.negative_prompt }}</textarea>

                        <button id="submit-button" type="submit">送信</button>
                    {% else %}
                        <div class="prompt">Prompt</div>
                        <textarea class="sidebar-textarea" name="prompt" id="prompt" rows="5" cols="30"
                                  placeholder="テキストを入力してください"></textarea>
                        <div class="prompt">Negative_Prompt</div>
                        <textarea class="sidebar-textarea" name="negative_prompt" id="negative_prompt" rows="5"
                                  cols="30"
                                  placeholder="テキストを入力してください"></textarea>

                        <button id="submit-button" type="submit">送信</button>
                    {% endif %}

                </form>


            {% endif %}
        </div>

        <div class="content">
            <!-- メインコンテンツ -->
            {% if image_name %}
                <div class="image-center" style="margin-bottom: -20%">
                    <img src="{% static image_name %}">
                </div>

            {% endif %}

            {% if image %}
                <div class="image-center" style="margin-bottom: -20%">
                    <img src="{% static image.image_path %}">
                </div>


            {% endif %}


        </div>

        <div class="sidebar sidebar-right">
            <h3 style="color: #EEEEEE;text-align: center;margin-top: -7%">プロンプト履歴</h3>
            <hr>
            {% if user.is_authenticated %}
                {% for i in Images reversed %}
                    <a href="{% url 'image_detail' i.imageID %}">prompt：{{ i.prompt }}<br>negative_prompt：{{ i.negative_prompt }}
                    </a>
                    <hr>
                {% endfor %}
            {% endif %}

        </div>
    {% else %}
        <dev class="position-absolute top-50 start-50 translate-middle">
            <div class="card " style="width: 18rem;">
                <div class="card-body">
                    <h5 class="card-title">Log in</h5>
                    <hr>
                    <p class="card-text">サービスを利用するにはログインが必要です。</p>
                    <a href="/auth/google/login/?next=/">
                        <button class="btn btn-primary">Google認証</button>
                    </a>
                </div>
            </div>


        </dev>
    {% endif %}
{% endblock %}